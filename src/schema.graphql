# import User from "./generated/schema/prisma.graphql"

#
# Directives
#
# Implements authorization rules.
directive @auth(
  permissions: [String!],
) on OBJECT | FIELD_DEFINITION

# Wraps returned types, duplicating the id field into an extra uuid field.
directive @uuid on FIELD_DEFINITION

#
# Scalars
#
scalar UUID
scalar JSON

#
# Types
#
type AuthUser {
  user: User @uuid
  token: Token
  permissions: JSON
  isAdmin: Boolean
}

type Token {
  value: String
  payload: TokenPayload
}

type TokenPayload {
  uuid: UUID
  iat: Int
  exp: Int
}

type AuthConfig {
  publicSignup: Boolean
  initialSignup: Boolean
  localEnabled: Boolean
  googleEnabled: Boolean
  githubEnabled: Boolean
  auth0Enabled: Boolean
  googleOAuthUrl: String
  githubOAuthUrl: String
  auth0OAuthUrl: String
}

#
# Queries
#
type Query {
  users(
    userUuid: UUID,
    username: String,
    email: String
  ): [User]

  authConfig(
    redirect: String
    duration: Int
    extras: JSON
    inviteToken: String
  ): AuthConfig
}

#
# Mutations
#
type Mutation {
  createUser(
    email: String!
    password: String!
    username: String
    profile: JSON
    inviteToken: String
    duration: Int
  ): AuthUser

  createToken(
    password: String!
    identity: String!
    duration: Int
  ): AuthUser

  resetPassword(
    token: String!
    password: String!
    duration: Int
  ): AuthUser
}
